!function(){"use strict";var e=require("fs"),n=require("path"),s=__dirname,i,a,t,r=/\{MANIFEST\-START\}[\s\S]*?\{MANIFEST\-END\}/g,o=n.join(n.dirname(s),"js","app-schemas.js"),c=n.join(s,"manifest.json"),l=[n.basename(__filename),"manifest.json","options.json","README.txt",".DS_Store","min"],m={},f=function(s){var i=s.substr(0,s.length-n.extname(s).length)+".json",a=n.dirname(s)+"/config.json",t;return e.existsSync&&e.existsSync(i)||n.existsSync&&n.existsSync(i)?t=i:e.existsSync&&e.existsSync(a)||n.existsSync&&n.existsSync(a)?t=a:(console.log("Can't find options file for schema at either "+i+" or "+a+". This file should define the schema-family so that Doctored.js can offer a better UI for editing. The schema-family value should align with a key in app-schemas.js and the variable doctored.schema_family = { ... "),process.exit()),JSON.parse(e.readFileSync(t))["schema-family"]},h=function(i,a){var t,r,o,c=[];for(t=0;t<i.length;t++)r=i[t],l.indexOf(r)>=0||".json"!==n.extname(r)&&(o=n.join(a,r),c.push(e.lstatSync(o).isDirectory()?{schema_family:r,children:h(e.readdirSync(o),o)}:{schema:o.replace(s,""),label:r.replace(n.extname(r),""),schema_family:f(o)}));return c};m=h(e.readdirSync(s),s),t=e.readFileSync(o,"utf8"),t.match(r)||(console.log("ERROR: No app_schemas_marker found in "+o),process.exit()),t=t.replace(r,function(e){return"{MANIFEST-START}\n    doctored.schemas_manifest = "+JSON.stringify(m)+";\n    // {MANIFEST-END}"}),e.writeFileSync(o,t),console.log("Done. Manifest written to "+o)}();